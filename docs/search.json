[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Landsat Analysis",
    "section": "",
    "text": "Elaborado: Rubén Basantes\n\nLandsat satellite images - Data Exploration\nThis cell load libraries needed for satellite image processing.\n\n\nCode\nlibrary(raster)\nlibrary(terra)\nlibrary(sp)\nlibrary(sf)\nlibrary(devtools)\nlibrary(dplyr)\nlibrary(RStoolbox)\n\n\nImport and print meta-data and bands based on MTL file for extract information. print() function shows the information of the image. RStoolbox::stackMeta() function read Landsat data and build a properly calibrated rasterstack from the bands. names() function give name to the layers or bands Answer the following questions: 1. What was the date and time when the Landsat scene was acquired? 2. What is the purpose of temporal resolution in this type of satelite image? 3. Explain the results of names() function\n\n\nCode\nmetaData &lt;- RStoolbox::readMeta(\"D:/Landsat_GIS&SR/010060_2013/LE70100602013116EDC00_MTL.txt\")\nprint(metaData)\n\n\n$METADATA_FILE\n[1] \"D:/Landsat_GIS&SR/010060_2013/LE70100602013116EDC00_MTL.txt\"\n\n$METADATA_FORMAT\n[1] \"MTL\"\n\n$SATELLITE\n[1] \"LANDSAT7\"\n\n$SENSOR\n[1] \"ETM\"\n\n$SCENE_ID\n[1] \"LE70100602013116EDC00\"\n\n$COLLECTION\ncollection       tier \n        NA         NA \n\n$ACQUISITION_DATE\n[1] \"2013-04-26 15:22:12 GMT\"\n\n$PROCESSING_DATE\n[1] \"2014-12-09 GMT\"\n\n$PATH_ROW\npath  row \n  10   60 \n\n$PROJECTION\nCoordinate Reference System:\n  User input: +proj=utm +zone=17 +units=m +datum=WGS84 +ellips=WGS84 \n  wkt:\nPROJCRS[\"unknown\",\n    BASEGEOGCRS[\"unknown\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8901]]],\n    CONVERSION[\"UTM zone 17N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",-81,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]],\n        ID[\"EPSG\",16017]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n$SOLAR_PARAMETERS\n  azimuth elevation  distance \n62.045642 59.636155  1.006109 \n\n$DATA\n                                           FILES        BANDS QUANTITY CATEGORY\nB1_dn               LE70100602013116EDC00_B1.TIF        B1_dn       dn    image\nB2_dn               LE70100602013116EDC00_B2.TIF        B2_dn       dn    image\nB3_dn               LE70100602013116EDC00_B3.TIF        B3_dn       dn    image\nB4_dn               LE70100602013116EDC00_B4.TIF        B4_dn       dn    image\nB5_dn               LE70100602013116EDC00_B5.TIF        B5_dn       dn    image\nB6_VCID_1_dn LE70100602013116EDC00_B6_VCID_1.TIF B6_VCID_1_dn       dn    image\nB6_VCID_2_dn LE70100602013116EDC00_B6_VCID_2.TIF B6_VCID_2_dn       dn    image\nB7_dn               LE70100602013116EDC00_B7.TIF        B7_dn       dn    image\nB8_dn               LE70100602013116EDC00_B8.TIF        B8_dn       dn      pan\n             NA_VALUE SATURATE_VALUE SCALE_FACTOR DATA_TYPE SPATIAL_RESOLUTION\nB1_dn              NA             NA            1        NA                 30\nB2_dn              NA             NA            1        NA                 30\nB3_dn              NA             NA            1        NA                 30\nB4_dn              NA             NA            1        NA                 30\nB5_dn              NA             NA            1        NA                 30\nB6_VCID_1_dn       NA             NA            1        NA                 30\nB6_VCID_2_dn       NA             NA            1        NA                 30\nB7_dn              NA             NA            1        NA                 30\nB8_dn              NA             NA            1        NA                 15\n             RADIOMETRIC_RESOLUTION\nB1_dn                             8\nB2_dn                             8\nB3_dn                             8\nB4_dn                             8\nB5_dn                             8\nB6_VCID_1_dn                      8\nB6_VCID_2_dn                      8\nB7_dn                             8\nB8_dn                             8\n\n$CALRAD\n               offset  gain\nB1_dn        -7.38071 1.181\nB2_dn        -7.60984 1.210\nB3_dn        -5.94252 0.943\nB4_dn        -6.06929 0.969\nB5_dn        -1.19122 0.191\nB6_VCID_1_dn -0.06709 0.067\nB6_VCID_2_dn  3.16280 0.037\nB7_dn        -0.41650 0.066\nB8_dn        -5.67559 0.976\n\n$CALREF\n[1] NA\n\n$CALBT\n                 K1      K2\nB6_VCID_1_dn 666.09 1282.71\nB6_VCID_2_dn 666.09 1282.71\n\nattr(,\"class\")\n[1] \"ImageMetaData\" \"RStoolbox\"    \n\n\nCode\n# Stacking refers to join the bands for make a single multilayer file. \nls &lt;- RStoolbox::stackMeta(metaData)\nls\n\n\nclass       : SpatRaster \nsize        : 6961, 8011, 8  (nrow, ncol, nlyr)\nresolution  : 30, 30  (x, y)\nextent      : 660585, 900915, -104115, 104715  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 17N (EPSG:32617) \nsources     : LE70100602013116EDC00_B1.TIF  \n              LE70100602013116EDC00_B2.TIF  \n              LE70100602013116EDC00_B3.TIF  \n              ... and 5 more sources\nnames       : B1_dn, B2_dn, B3_dn, B4_dn, B5_dn, B6_VCID_1_dn, ... \nmin values  :     0,    ? ,     0,    ? ,    ? ,           ? , ... \nmax values  :   255,    ? ,   255,    ? ,    ? ,           ? , ... \n\n\nCode\n# information of bands\n# gives names to bands\nnames(ls) &lt;- c('blue', 'green', 'red', 'NIR', 'SWIR1', 'Thermal_1', 'Thermal_2', 'SWIR2')\nls\n\n\nclass       : SpatRaster \nsize        : 6961, 8011, 8  (nrow, ncol, nlyr)\nresolution  : 30, 30  (x, y)\nextent      : 660585, 900915, -104115, 104715  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 17N (EPSG:32617) \nsources     : LE70100602013116EDC00_B1.TIF  \n              LE70100602013116EDC00_B2.TIF  \n              LE70100602013116EDC00_B3.TIF  \n              ... and 5 more sources\nnames       : blue, green, red,  NIR, SWIR1, Thermal_1, ... \nmin values  :    0,    ? ,   0,   ? ,    ? ,        ? , ... \nmax values  :  255,    ? , 255,   ? ,    ? ,        ? , ... \n\n\nCode\n# provide internal information of the bands\nnlyr(ls)\n\n\n[1] 8\n\n\nCode\ncrs(ls)\n\n\n[1] \"PROJCRS[\\\"WGS 84 / UTM zone 17N\\\",\\n    BASEGEOGCRS[\\\"WGS 84\\\",\\n        ENSEMBLE[\\\"World Geodetic System 1984 ensemble\\\",\\n            MEMBER[\\\"World Geodetic System 1984 (Transit)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G730)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G873)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G1150)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G1674)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G1762)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G2139)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G2296)\\\"],\\n            ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                LENGTHUNIT[\\\"metre\\\",1]],\\n            ENSEMBLEACCURACY[2.0]],\\n        PRIMEM[\\\"Greenwich\\\",0,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        ID[\\\"EPSG\\\",4326]],\\n    CONVERSION[\\\"UTM zone 17N\\\",\\n        METHOD[\\\"Transverse Mercator\\\",\\n            ID[\\\"EPSG\\\",9807]],\\n        PARAMETER[\\\"Latitude of natural origin\\\",0,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8801]],\\n        PARAMETER[\\\"Longitude of natural origin\\\",-81,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8802]],\\n        PARAMETER[\\\"Scale factor at natural origin\\\",0.9996,\\n            SCALEUNIT[\\\"unity\\\",1],\\n            ID[\\\"EPSG\\\",8805]],\\n        PARAMETER[\\\"False easting\\\",500000,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8806]],\\n        PARAMETER[\\\"False northing\\\",0,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8807]]],\\n    CS[Cartesian,2],\\n        AXIS[\\\"(E)\\\",east,\\n            ORDER[1],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        AXIS[\\\"(N)\\\",north,\\n            ORDER[2],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n    USAGE[\\n        SCOPE[\\\"Navigation and medium accuracy spatial referencing.\\\"],\\n        AREA[\\\"Between 84°W and 78°W, northern hemisphere between equator and 84°N, onshore and offshore. Bahamas. Ecuador - north of equator. Canada - Nunavut; Ontario; Quebec. Cayman Islands. Colombia. Costa Rica. Cuba. Jamaica. Nicaragua. Panama. United States (USA).\\\"],\\n        BBOX[0,-84,84,-78]],\\n    ID[\\\"EPSG\\\",32617]]\"\n\n\nCode\nncell(ls)\n\n\n[1] 55764571\n\n\nCode\ndim(ls)\n\n\n[1] 6961 8011    8\n\n\nCode\nres(ls)\n\n\n[1] 30 30\n\n\nCode\n# plots the satelite images \nplot(ls)\n\n\n\n\n\n\n\n\n\nImport a single RasterLayer objects from Landsat bands: b1=bleu and b2=red. 4. Identify and print the information for NIR and SWIR bands. 5. What is the spaial resolution of those images?\n\n\nCode\nb1 &lt;- raster::raster('D:/Landsat_GIS&SR/010060_2013/LE70100602013116EDC00_B1.TIF')\nb2 &lt;- raster::raster('D:/Landsat_GIS&SR/010060_2013/LE70100602013116EDC00_B2.TIF')\n\n\nAbove we created a RasterStack with ‘n’ layers. The layers represent DN in 8bits of radiometric resolution.  The reflection intensity can be computed by an at-surface reflexion algorithm, this going to be shows in the next session. 6. What is the purpose of radiometric resolution in this type of satelite image?\n\n\nCode\n# You can plot individual layers of a RasterStack of a multi-spectral image.\npar(mfrow = c(1,2))\nplot(b1, main = \"Blue\", col = gray(0:100 / 100))\nplot(b2, main = \"Green\", col = gray(0:100 / 100))\n\n\n\n\n\n\n\n\n\nHave a look at the legends of the maps created above. They can range between 0 and 255. Notice the difference in shading and range of legends between the different bands. This is because different surface features reflect the incident solar radiation differently. Each layer represent how much incident solar radiation is reflected for a particular wavelength range. For example, vegetation reflects more energy in NIR than other wavelengths and thus appears brighter. In contrast, water absorbs most of the energy in the NIR wavelength and it appears dark. We do not gain that much information from these grey-scale plots; they are often combined into a composite to create more interesting plots. To make a true (or natural) color image, that is, something that looks like a normal photograph (vegetation in green,water blue etc), we need bands in the red, green and blue regions. The plotRGB method can be used to combine them into a single composite. You can also supply additional arguments to plotRGB to improve the visualization (e.g. a linear stretch of the values, using strecth = “lin”).\n\n\nCode\n# Cargar bandas\nb1 &lt;- raster('D:/Landsat_GIS&SR/010060_2013/LE70100602013116EDC00_B1.TIF')\nb2 &lt;- raster('D:/Landsat_GIS&SR/010060_2013/LE70100602013116EDC00_B2.TIF')\nb3 &lt;- raster('D:/Landsat_GIS&SR/010060_2013/LE70100602013116EDC00_B3.TIF')\n\n# Crear stack RGB (R=rojo, G=verde, B=azul)\nlandsatRGB &lt;- stack(b3, b2, b1)\n\n# Mostrar como color verdadero\nplotRGB(landsatRGB, axes = TRUE, stretch = \"hist\",\n        main = \"Landsat True Color Composite\")\n\n\n\n\n\n\n\n\n\n7. Now, using landsatRGB create false color composite map by using band 4 (NIR), 3 (green), and 2 (blue) can be used.\n\n\nCode\n# load bands\n\n# Create stack RGB \n\n# Mostrar como falso color verdadero\n\n\nsubset() function select only certain bands from the multi-band raster object ls.\n\n\nCode\nls_sub &lt;- subset(ls, 1:3) # 1:7 \nls_sub\n\n\nclass       : SpatRaster \nsize        : 6961, 8011, 3  (nrow, ncol, nlyr)\nresolution  : 30, 30  (x, y)\nextent      : 660585, 900915, -104115, 104715  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 17N (EPSG:32617) \nsources     : LE70100602013116EDC00_B1.TIF  \n              LE70100602013116EDC00_B2.TIF  \n              LE70100602013116EDC00_B3.TIF  \nnames       : blue, green, red \nmin values  :    0,    ? ,   0 \nmax values  :  255,    ? , 255 \n\n\next() function provides the coordinated of the spatial domain of the image. 8. In this activity, we will reduce the area of our satellite image by selecting only a specific region of interest. To do this, we will use coordinates extracted from Google Earth and apply them to define the geographic boundaries of the crop. Write down the minimum and maximum of the new coordinates (left, right, bottom, and top limits) of the area. Finally, use the resulting extent to crop your full image.\n\n\nCode\next(ls_sub)\n\n\nSpatExtent : 660585, 900915, -104115, 104715 (xmin, xmax, ymin, ymax)\n\n\nCode\n# The extension is obtained by Google Earth\ne &lt;- extent(788107, 800382, 31599, 41875)\n# crop landsat by the extent\nls_sub_crop&lt;- crop(ls_sub, e)\nplot(ls_sub_crop)\n\n\n\n\n\n\n\n\n\nInstead of cropping the image using numeric coordinates, in this method we use a vector shapefile that represents the area of interest (AOI). This shapefile typically comes from GIS software (like QGIS, ArcGIS, or Google Earth exports). For doing so, we will use the Area of Interest (AOI) of Pichincha. 9. In your own words, explain the purpose of the crs() function in this specific example. Describe why we check the coordinate reference system (CRS) of both the raster and the vector layer before cropping. Then, add your explanation as comments inside the code, with proper indentation and clear wording.\n\n\nCode\naoi &lt;- vect(\"D:/Landsat_GIS&SR/data/AOI_Pichincha.shp\")  # Check the projection of the vector\ncrs(aoi)\n\n\n[1] \"PROJCRS[\\\"WGS 84 / UTM zone 17S\\\",\\n    BASEGEOGCRS[\\\"WGS 84\\\",\\n        DATUM[\\\"World Geodetic System 1984\\\",\\n            ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                LENGTHUNIT[\\\"metre\\\",1]]],\\n        PRIMEM[\\\"Greenwich\\\",0,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        ID[\\\"EPSG\\\",4326]],\\n    CONVERSION[\\\"UTM zone 17S\\\",\\n        METHOD[\\\"Transverse Mercator\\\",\\n            ID[\\\"EPSG\\\",9807]],\\n        PARAMETER[\\\"Latitude of natural origin\\\",0,\\n            ANGLEUNIT[\\\"Degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8801]],\\n        PARAMETER[\\\"Longitude of natural origin\\\",-81,\\n            ANGLEUNIT[\\\"Degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8802]],\\n        PARAMETER[\\\"Scale factor at natural origin\\\",0.9996,\\n            SCALEUNIT[\\\"unity\\\",1],\\n            ID[\\\"EPSG\\\",8805]],\\n        PARAMETER[\\\"False easting\\\",500000,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8806]],\\n        PARAMETER[\\\"False northing\\\",10000000,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8807]]],\\n    CS[Cartesian,2],\\n        AXIS[\\\"(E)\\\",east,\\n            ORDER[1],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        AXIS[\\\"(N)\\\",north,\\n            ORDER[2],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n    ID[\\\"EPSG\\\",32717]]\"\n\n\nCode\ncrs(ls_sub)\n\n\n[1] \"PROJCRS[\\\"WGS 84 / UTM zone 17N\\\",\\n    BASEGEOGCRS[\\\"WGS 84\\\",\\n        ENSEMBLE[\\\"World Geodetic System 1984 ensemble\\\",\\n            MEMBER[\\\"World Geodetic System 1984 (Transit)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G730)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G873)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G1150)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G1674)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G1762)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G2139)\\\"],\\n            MEMBER[\\\"World Geodetic System 1984 (G2296)\\\"],\\n            ELLIPSOID[\\\"WGS 84\\\",6378137,298.257223563,\\n                LENGTHUNIT[\\\"metre\\\",1]],\\n            ENSEMBLEACCURACY[2.0]],\\n        PRIMEM[\\\"Greenwich\\\",0,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        ID[\\\"EPSG\\\",4326]],\\n    CONVERSION[\\\"UTM zone 17N\\\",\\n        METHOD[\\\"Transverse Mercator\\\",\\n            ID[\\\"EPSG\\\",9807]],\\n        PARAMETER[\\\"Latitude of natural origin\\\",0,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8801]],\\n        PARAMETER[\\\"Longitude of natural origin\\\",-81,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8802]],\\n        PARAMETER[\\\"Scale factor at natural origin\\\",0.9996,\\n            SCALEUNIT[\\\"unity\\\",1],\\n            ID[\\\"EPSG\\\",8805]],\\n        PARAMETER[\\\"False easting\\\",500000,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8806]],\\n        PARAMETER[\\\"False northing\\\",0,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8807]]],\\n    CS[Cartesian,2],\\n        AXIS[\\\"(E)\\\",east,\\n            ORDER[1],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        AXIS[\\\"(N)\\\",north,\\n            ORDER[2],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n    USAGE[\\n        SCOPE[\\\"Navigation and medium accuracy spatial referencing.\\\"],\\n        AREA[\\\"Between 84°W and 78°W, northern hemisphere between equator and 84°N, onshore and offshore. Bahamas. Ecuador - north of equator. Canada - Nunavut; Ontario; Quebec. Cayman Islands. Colombia. Costa Rica. Cuba. Jamaica. Nicaragua. Panama. United States (USA).\\\"],\\n        BBOX[0,-84,84,-78]],\\n    ID[\\\"EPSG\\\",32617]]\"\n\n\nCode\naoi &lt;- project(aoi, crs(ls_sub))\nls_sub_mask &lt;- mask(ls_sub, aoi)\n\n\n\n|---------|---------|---------|---------|\n=========================================\n                                          \n\n|---------|---------|---------|---------|\n=========================================\n                                          \n\n\nCode\nplot(ls_sub_mask)\n\n\n\n\n\n\n\n\n\nThe cell below combines the three bands (blue, green, red) from ls_sub_crop variable into a single SpatRaster object. Then use the plotRGB() function to display the image in true color map. The plotRGB() function determines which band will be shown as red, green, and blue in the final image - For improving the visualization we apply a simple contrast adjustment stretch = “lin”. - For improving the visualization we also apply the contrast stretch = “hist”*.\n\n\nCode\n# Combine bands as RGB SpatRaster\nlandsatRGB &lt;- c(ls_sub_crop$blue, ls_sub_crop$green, ls_sub_crop$red)\n\nplotRGB(landsatRGB, r=3, g=2, b=1, stretch=\"lin\")\ntitle(\"Landsat True Color Composite\", font.main = 2)\n\n\n\n\n\n\n\n\n\nCode\nplotRGB(landsatRGB, r=3, g=2, b=1, stretch=\"hist\")\ntitle(\"Landsat True Color Composite\", font.main = 2)\n\n\n\n\n\n\n\n\n\n10. Repeat all the explanaition above but crate a False Color Composite Map. explain thw differences when using linear improvements and histogram improvements.\nSaving results:\n\n\nCode\nwriteRaster(ls_sub_mask, filename=\"D:/Landsat_GIS&SR/010060_2013/output/mask-landsat.tif\", overwrite=TRUE)\n\n\n\n|---------|---------|---------|---------|\n=========================================\n                                          \n\n\nThe function pairs() creates a scatterplot matrix. This means it compares each selected band against the others to show how strongly their pixel values are related. Look carefully at the scatterplots produced by these two lines of code. Then answer the following questions:\n11. Do the Blue and Green bands show a strong or weak relationship? Explain what this means about surface reflectance in the visible spectrum.\n12. In the second scatterplot (Red vs IR bands), identify the cluster of points that likely represents vegetation.\n13. Based on the scatterplots, which bands seem most useful for distinguishing different land cover types? Justify your answer using patterns you see in the point clusters.\n\n\nCode\npairs(ls_sub_crop[[1:2]], main = \"blue versus green\")\n\n\n\n\n\n\n\n\n\nCode\npairs(ls[[1:5]], main = \"Red versus IR\")\n\n\n\n\n\n\n\n\n\nFor Landsat7 the following wavelengths exist: Blue, Green, Red, Near Infrared (NIR), Shortwave Infrared (SWIR ) 1, Shortwave Infrared (SWIR) 2, Panchromatic, Cirrus, Thermal Infrared (TIRS) 1, Thermal Infrared (TIRS) 2. We wont use the Thermal layers and you will see how to remove those in following sections.\n\n\nCode\nsmpl &lt;- vect(\"D:/Landsat_GIS&SR/data/Samples_pch.shp\")# Check the projection of the vector\n\n# Extract raster value at sample point locations\ndf &lt;- raster::extract(ls, smpl)\ndf\n\n\n  ID blue green red NIR SWIR1 Thermal_1 Thermal_2 SWIR2\n1  1   43    30  24  60    32       123       135    17\n2  2   52    44  43  67    74       143       172    53\n3  3   42    35  30  77    47       127       142    26\n4  4   39    34  35  58    57       129       147    33\n5  5   42    41  34 108    69       127       143    35\n\n\nCode\n# remove Thermal bands\ndf &lt;- df %&gt;% select(-Thermal_1&-Thermal_2)\n# add the land cover class to the points\ndf$Clase &lt;- smpl$Clase\n\n# Convert to long format\nlibrary(tidyr)\nlibrary(ggplot2)\ndf_long &lt;- df %&gt;%\n  pivot_longer(cols = c(\"blue\", \"green\", \"red\", \"NIR\", \"SWIR1\", \"SWIR2\"),\n               names_to = \"Band\",\n               values_to = \"Reflectance\")\n\nggplot(df_long, aes(x = Band, y = Reflectance, color = Clase, group = Clase)) +\n  stat_summary(fun = mean, geom = \"line\", linewidth = 1.4) +\n  stat_summary(fun = mean, geom = \"point\", size = 3) +\n  theme_minimal(base_size = 14) +\n  labs(title = \"Mean Spectral Profile per Class\",\n       x = \"Spectral Band\",\n       y = \"Reflectance\")"
  }
]